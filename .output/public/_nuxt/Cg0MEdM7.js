import{ap as o}from"./B1S4txnq.js";import{l as r,L as t}from"./Bx7J-uke.js";const l=o("user",{state:()=>({user_id:null,user_name:null,user_picture:null}),actions:{async loginWithLINE(){if(typeof window>"u")return;if(await r.init({liffId:t}),!r.isLoggedIn()){r.login();return}const e=await r.getProfile();this.user_id=e.userId,this.user_name=e.displayName,this.user_picture=e.pictureUrl??null,localStorage.setItem("user_id",e.userId),localStorage.setItem("user_name",e.displayName),localStorage.setItem("user_picture",e.pictureUrl??"")},logout(){typeof window>"u"||(r.logout(),this.user_id=null,this.user_name=null,this.user_picture=null,localStorage.removeItem("user_id"),localStorage.removeItem("user_name"),localStorage.removeItem("user_picture"))},loadUser(){if(typeof window>"u")return;const e=localStorage.getItem("user_id"),s=localStorage.getItem("user_name"),i=localStorage.getItem("user_picture");e&&(this.user_id=e,this.user_name=s,this.user_picture=i)},async checkLoginStatus(){if(!(typeof window>"u")&&(this.loadUser(),!this.user_id&&(await r.init({liffId:t}),r.isLoggedIn())))try{const e=await r.getProfile();this.user_id=e.userId,this.user_name=e.displayName,this.user_picture=e.pictureUrl??null,localStorage.setItem("user_id",e.userId),localStorage.setItem("user_name",e.displayName),localStorage.setItem("user_picture",e.pictureUrl??"")}catch(e){console.error("获取 LIFF 用户信息失败",e)}}}});export{l as u};
